# üìã Guide Utilisateur - Suivi Encaissement CIE

## üè¢ **Pr√©sentation de l'Application**

L'application **Suivi Encaissement** est une plateforme web d√©velopp√©e pour la **Compagnie Ivoirienne d'√âlectricit√© (CIE)** permettant de g√©rer et suivre l'ensemble du processus d'encaissement des paiements clients.

### **Objectifs**

- Digitaliser le processus de suivi des encaissements
- Automatiser les t√¢ches r√©p√©titives
- Am√©liorer la tra√ßabilit√© des op√©rations
- R√©duire les erreurs manuelles
- Acc√©l√©rer le traitement des encaissements

---

## üöÄ **D√©marrage Rapide**

### **Pr√©requis**

- Navigateur web moderne (Chrome, Firefox, Safari, Edge)
- Connexion internet stable
- Compte utilisateur valide avec habilitations appropri√©es

### **Acc√®s √† l'application**

1. Ouvrez votre navigateur web
2. Acc√©dez √† l'URL de l'application
3. Connectez-vous avec vos identifiants
4. Si c'est votre premi√®re connexion, vous devrez changer votre mot de passe

---

## üè† **Tableau de Bord (Dashboard)**

### **Vue d'ensemble**

Le tableau de bord offre une vision globale des encaissements avec :

- **Taux de compl√©tion global** : Pourcentage des encaissements trait√©s
- **Montants totaux** : Bordereau, Relev√© et Total
- **Graphiques de progression** : Visualisation des tendances
- **Alertes et notifications** : Informations importantes
- **Filtres dynamiques** : Par Direction R√©gionale, secteurs, p√©riodes

### **Fonctionnalit√©s principales**

- **Vue graphique/tableau** : Basculement entre les modes d'affichage
- **Filtres avanc√©s** : S√©lection par DR, exploitation, dates
- **Export de donn√©es** : G√©n√©ration de rapports Excel/PDF
- **Actualisation en temps r√©el** : Donn√©es mises √† jour automatiquement

---

## üí∞ **Module Encaissements**

### **Statuts des encaissements**

L'application g√®re 8 statuts diff√©rents :

1. **Encaissements Charg√©s** (0) : Donn√©es import√©es, en attente de traitement
2. **Encaissements V√©rifi√©s** (2) : Donn√©es contr√¥l√©es et valid√©es
3. **Encaissements Rejet√©s** (1) : Donn√©es rejet√©es pour correction
4. **Encaissements Valid√©s** (3) : Approuv√©s par les superviseurs
5. **Encaissements Trait√©s** (7) : Finalis√©s et comptabilis√©s
6. **R√©clamations Revers√©es** (4) : Cas particuliers en traitement
7. **Encaissements Cl√¥tur√©s** (5) : Processus termin√©
8. **R√©clamations Trait√©es** (6) : R√©clamations r√©solues

### **Actions disponibles**

- **Validation en masse** : Traitement de plusieurs encaissements
- **Modification individuelle** : √âdition des d√©tails d'un encaissement
- **Ajout d'observations** : Commentaires sur les op√©rations
- **Upload de documents** : Pi√®ces justificatives (images, PDF)
- **Export de donn√©es** : G√©n√©ration de rapports

### **Filtres et recherche**

- **Direction R√©gionale** : Filtrage par zone g√©ographique
- **Secteurs/Exploitations** : Filtrage par unit√© op√©rationnelle
- **P√©riodes** : S√©lection de dates sp√©cifiques
- **Banques** : Filtrage par √©tablissement bancaire
- **Statuts** : Filtrage par √©tat de traitement

---

## üîó **Module Rapprochement**

### **Fonctionnalit√©s**

- **Rapprochement automatique** : Mise en correspondance des donn√©es
- **Gestion des √©carts** : Identification et traitement des diff√©rences
- **Validation des correspondances** : Approbation des rapprochements
- **Historique des op√©rations** : Tra√ßabilit√© compl√®te

### **Types de rapprochement**

- **Rapprochement Jade** : Syst√®me principal
- **Rapprochement Smart** : Syst√®me intelligent
- **Rapprochement Timbre** : Syst√®me sp√©cialis√©

---

## ‚öñÔ∏è **Module Litiges**

### **Gestion des cas particuliers**

- **Cr√©ation de litiges** : Saisie des cas probl√©matiques
- **Suivi des r√©solutions** : Traitement des litiges
- **Documentation** : Pi√®ces justificatives et observations
- **Validation des solutions** : Approbation des r√©solutions

---

## üìä **Module √âtat des Encaissements**

### **Rapports et analyses**

- **√âtats d√©taill√©s** : Rapports complets par p√©riode
- **Analyses comparatives** : Comparaisons entre p√©riodes
- **Indicateurs de performance** : KPIs et m√©triques
- **Export de rapports** : G√©n√©ration de documents

---

## üë• **Module Administration**

### **Gestion des utilisateurs**

- **Cr√©ation de comptes** : Ajout de nouveaux utilisateurs
- **Gestion des profils** : Modification des informations
- **Attribution des habilitations** : D√©finition des droits d'acc√®s
- **Suivi des connexions** : Historique des acc√®s

### **Gestion des habilitations**

- **D√©finition des r√¥les** : Cr√©ation de profils utilisateurs
- **Attribution des permissions** : Droits LIRE/ECRIRE/SUPPRIMER
- **Gestion des acc√®s** : Contr√¥le des fonctionnalit√©s
- **Audit des droits** : V√©rification des habilitations

### **Param√®tres syst√®me**

- **Configuration g√©n√©rale** : Param√®tres de l'application
- **Gestion des r√©f√©rences** : Codes et libell√©s
- **Maintenance** : Outils d'administration

---

## üîß **Fonctionnalit√©s Techniques**

### **Interface utilisateur**

- **Design responsive** : Adaptation √† tous les √©crans
- **Mode sombre/clair** : Personnalisation de l'affichage
- **Navigation intuitive** : Menu et breadcrumbs
- **Notifications** : Alertes et messages d'information

### **S√©curit√©**

- **Authentification s√©curis√©e** : Connexion prot√©g√©e
- **Gestion des sessions** : Contr√¥le des acc√®s
- **Audit trail** : Tra√ßabilit√© des actions
- **Chiffrement des donn√©es** : Protection des informations

### **Performance**

- **Pagination** : Chargement optimis√© des donn√©es
- **Recherche rapide** : Filtrage en temps r√©el
- **Cache intelligent** : Mise en cache des donn√©es
- **Actualisation automatique** : Donn√©es √† jour

---

## üì± **Utilisation Mobile**

### **Compatibilit√©**

- **Tablettes** : Interface adapt√©e aux √©crans moyens
- **Smartphones** : Version mobile optimis√©e
- **Navigation tactile** : Gestes et interactions tactiles
- **Performance optimis√©e** : Chargement rapide sur mobile

---

## üÜò **Support et Aide**

### **Ressources disponibles**

- **Guide d'utilisation** : Documentation compl√®te
- **Tutoriels int√©gr√©s** : Aide contextuelle
- **FAQ** : Questions fr√©quentes
- **Support technique** : Assistance en cas de probl√®me

### **Contact support**

- **Email** : support@cie.ci
- **T√©l√©phone** : +225 XX XX XX XX
- **Chat en ligne** : Support int√©gr√© √† l'application

---

## üîÑ **Mises √† jour et Maintenance**

### **Nouvelles fonctionnalit√©s**

- **Mises √† jour r√©guli√®res** : Am√©liorations continues
- **Nouvelles fonctionnalit√©s** : √âvolution de l'application
- **Corrections de bugs** : R√©solution des probl√®mes
- **Optimisations** : Am√©lioration des performances

### **Maintenance pr√©ventive**

- **Sauvegardes automatiques** : Protection des donn√©es
- **Maintenance programm√©e** : Interventions planifi√©es
- **Monitoring** : Surveillance continue
- **S√©curit√©** : Mises √† jour de s√©curit√©

---

## üìã **Checklist Utilisateur**

### **Avant de commencer**

- [ ] V√©rifier votre connexion internet
- [ ] Avoir vos identifiants de connexion
- [ ] V√©rifier vos habilitations
- [ ] Consulter les notifications importantes

### **Utilisation quotidienne**

- [ ] Consulter le tableau de bord
- [ ] Traiter les encaissements en attente
- [ ] V√©rifier les rapprochements
- [ ] G√©rer les litiges √©ventuels
- [ ] Exporter les rapports n√©cessaires

### **Fin de journ√©e**

- [ ] Valider les op√©rations en cours
- [ ] Sauvegarder les modifications
- [ ] Consulter les statistiques
- [ ] Planifier les t√¢ches du lendemain

---

## üéØ **Bonnes Pratiques**

### **S√©curit√©**

- Changez r√©guli√®rement votre mot de passe
- Ne partagez jamais vos identifiants
- D√©connectez-vous apr√®s chaque session
- Signalez tout comportement suspect

### **Efficacit√©**

- Utilisez les raccourcis clavier
- Organisez vos filtres fr√©quents
- Sauvegardez r√©guli√®rement vos travaux
- Consultez l'aide en ligne si n√©cessaire

### **Collaboration**

- Communiquez avec votre √©quipe
- Partagez les bonnes pratiques
- Signalez les am√©liorations possibles
- Participez aux formations

---

## üìû **Contact et Support**

Pour toute question ou assistance :

**Support Technique**

- Email : support@cie.ci
- T√©l√©phone : +225 XX XX XX XX
- Horaires : 8h00 - 18h00 (Lun-Ven)

**Administrateur Syst√®me**

- Email : admin@cie.ci
- T√©l√©phone : +225 XX XX XX XX

---

## üîß **Guide Technique - Backend API**

### **Table des Mati√®res**

1. [Introduction](#introduction)
2. [Pr√©sentation du Syst√®me](#pr√©sentation-du-syst√®me)
3. [Architecture Technique](#architecture-technique)
4. [Installation et Configuration](#installation-et-configuration)
5. [Authentification](#authentification)
6. [Modules Fonctionnels](#modules-fonctionnels)
7. [Interface d'Administration](#interface-dadministration)
8. [API et Endpoints](#api-et-endpoints)
9. [Gestion des Permissions](#gestion-des-permissions)
10. [Rapports et Statistiques](#rapports-et-statistiques)
11. [Maintenance et Troubleshooting](#maintenance-et-troubleshooting)
12. [FAQ](#faq)

---

### **Introduction**

Le **Syst√®me de Suivi des Encaissements CIE** est une application web d√©velopp√©e pour la Compagnie Ivoirienne d'√âlectricit√© (CIE) permettant de g√©rer, suivre et valider les encaissements effectu√©s dans les diff√©rentes agences et points de collecte.

#### **Objectifs du Syst√®me**

- **Centralisation** : Centraliser tous les encaissements de la CIE
- **Tra√ßabilit√©** : Assurer un suivi complet des transactions
- **Validation** : Mettre en place un workflow de validation multi-niveaux
- **Rapprochement** : Faciliter le rapprochement comptable entre diff√©rents syst√®mes
- **Alertes** : G√©n√©rer des alertes pour les dossiers n√©cessitant une attention particuli√®re

---

### **Pr√©sentation du Syst√®me**

#### **Fonctionnalit√©s Principales**

1. **Gestion des Encaissements**

   - Enregistrement des transactions
   - Suivi des modes de r√®glement (ch√®que, esp√®ces)
   - Gestion des bordereaux bancaires
   - Calcul automatique des √©carts

2. **Workflow de Validation**

   - Validation par niveaux hi√©rarchiques
   - Gestion des observations et commentaires
   - Traitement des r√©clamations
   - Cl√¥ture des dossiers

3. **Rapprochements Comptables**

   - Rapprochement JADE/SAPHIR
   - Rapprochement JADE/SMART
   - Rapprochement des timbres

4. **Tableaux de Bord**
   - Statistiques en temps r√©el
   - Graphiques de performance
   - Alertes et notifications

---

### **Architecture Technique**

#### **Technologies Utilis√©es**

- **Backend** : NestJS (Node.js)
- **Base de Donn√©es** : MySQL avec Prisma ORM
- **Authentification** : JWT + Keycloak (optionnel)
- **Email** : Nodemailer
- **Upload de Fichiers** : Multer
- **Documentation API** : Swagger (implicite)

#### **Structure du Projet**

```
src/
‚îú‚îÄ‚îÄ auth/                 # Module d'authentification
‚îú‚îÄ‚îÄ users/               # Gestion des utilisateurs
‚îú‚îÄ‚îÄ encaissements/       # Module principal encaissements
‚îú‚îÄ‚îÄ dashboard/           # Tableaux de bord
‚îú‚îÄ‚îÄ rapprochements/      # Rapprochements comptables
‚îú‚îÄ‚îÄ mail/                # Service d'emails
‚îú‚îÄ‚îÄ shared/              # Services partag√©s
‚îÇ   ‚îú‚îÄ‚îÄ guards/          # Guards d'authentification
‚îÇ   ‚îú‚îÄ‚îÄ interceptors/    # Intercepteurs
‚îÇ   ‚îú‚îÄ‚îÄ services/        # Services utilitaires
‚îÇ   ‚îî‚îÄ‚îÄ utils/           # Fonctions utilitaires
‚îî‚îÄ‚îÄ main.ts             # Point d'entr√©e
```

---

### **Installation et Configuration**

#### **Pr√©requis**

- Node.js (version 16+)
- MySQL (version 8+)
- npm ou yarn

#### **Installation**

1. **Cloner le repository**

```bash
git clone [URL_DU_REPO]
cd suivi_encaissement_api
```

2. **Installer les d√©pendances**

```bash
npm install
```

3. **Configuration de l'environnement**
   Cr√©er un fichier `.env` avec les variables suivantes :

```env
# Base de donn√©es
DATABASE_URL="mysql://user:password@localhost:3306/suivi_encaissement_db"

# JWT
JWT_SECRET="votre_secret_jwt"
REFRESH_TOKEN_SECRET="votre_secret_refresh_token"

# Frontend URL
FRONTEND_URL="http://localhost:3000"

# Email
MAIL_HOST="smtp.exemple.com"
MAIL_PORT=587
MAIL_USER="user@exemple.com"
MAIL_PASSWORD="password"

# Port du serveur
PORT=2402
```

4. **Configuration de la base de donn√©es**

```bash
# G√©n√©rer le client Prisma
npm run g

# Appliquer les migrations
npm run m
```

5. **D√©marrer l'application**

```bash
# Mode d√©veloppement
npm run dev

# Mode production
npm run start:prod
```

---

### **Authentification**

#### **Syst√®me d'Authentification**

Le syst√®me utilise un double syst√®me d'authentification :

- **JWT** pour les sessions
- **Keycloak** (optionnel) pour l'int√©gration SSO

#### **Processus de Connexion**

1. **Inscription d'un nouvel utilisateur**

   - POST `/auth/sign-up`
   - N√©cessite les droits administrateur
   - Envoi automatique d'email avec identifiants

2. **Connexion**

   - POST `/auth/sign-in`
   - Login possible avec email ou matricule
   - Retourne un access_token et refresh_token

3. **Premi√®re connexion**
   - L'utilisateur doit changer son mot de passe
   - POST `/auth/change-password-first-login`

#### **Gestion des Mots de Passe**

1. **Mot de passe par d√©faut** : `Encaissement2024`

2. **R√©initialisation**

   - Demande : POST `/auth/request-reset-password`
   - R√©initialisation : POST `/auth/reset-password`
   - Code OTP envoy√© par email

3. **Changement de mot de passe**
   - POST `/auth/change-password`

#### **Tokens et Sessions**

- **Access Token** : Dur√©e de vie 2 heures
- **Refresh Token** : Dur√©e de vie 4 heures
- D√©connexion automatique apr√®s expiration

---

### **Modules Fonctionnels**

#### **1. Module Encaissements**

##### **Gestion des Encaissements**

**Endpoints principaux :**

- `GET /encaissements` - Liste pagin√©e des encaissements
- `GET /encaissements/alerts` - Encaissements n√©cessitant attention
- `POST /encaissements/treatment` - Traitement d'un encaissement
- `GET /encaissements/banques` - Liste des banques
- `GET /encaissements/produits` - Liste des produits

##### **Statuts des Encaissements**

1. **CHARGES** (0) : Encaissement cr√©√©, en attente de v√©rification
2. **VERIFIES** (1) : Encaissement v√©rifi√© par le premier niveau
3. **TRAITES** (2) : Encaissement trait√© par le second niveau
4. **RECLAMATION** (3) : Encaissement en r√©clamation
5. **CLOTURES** (4) : Encaissement cl√¥tur√©

##### **Workflow de Validation**

```mermaid
graph TD
    A[Encaissement cr√©√©] --> B[CHARGES]
    B --> C[V√©rification N1]
    C --> D[VERIFIES]
    D --> E[Traitement N2]
    E --> F[TRAITES]
    F --> G[CLOTURES]
    D --> H[RECLAMATION]
    H --> E
```

##### **Champs d'un Encaissement**

- **Identification**

  - `directionRegionale` : Direction r√©gionale
  - `codeExpl` : Code d'exploitation
  - `libelleExpl` : Libell√© d'exploitation

- **Caisse**

  - `dateEncaissement` : Date de l'encaissement
  - `codeCaisse` : Code de la caisse
  - `numeroCaisse` : Num√©ro de caisse
  - `numeroJourneeCaisse` : Journ√©e de caisse
  - `matriculeCaissiere` : Matricule de la caissi√®re
  - `fullnameCaissiere` : Nom complet de la caissi√®re

- **Montants**

  - `montantCheque` : Montant ch√®que
  - `montantEspece` : Montant esp√®ces
  - `montantBordereauBanqueCheque` : Montant bordereau banque (ch√®que)
  - `montantBordereauBanqueEspece` : Montant bordereau banque (esp√®ce)

- **Bancaire**

  - `banque` : Nom de la banque
  - `compteBanque` : Num√©ro de compte
  - `codeBanque` : Code banque
  - `numeroBordereau` : Num√©ro de bordereau

- **√âcarts calcul√©s**
  - `ecartCaisseBanqueCheque` : √âcart caisse/banque (ch√®que)
  - `ecartCaisseBanqueEspece` : √âcart caisse/banque (esp√®ce)

#### **2. Module Dashboard**

##### **Indicateurs Principaux**

1. **Taux de Completion**

   - Total des dossiers
   - Dossiers cl√¥tur√©s
   - Dossiers en r√©clamation
   - Dossiers valid√©s
   - Dossiers revers√©s

2. **Top 5 des Caisses**

   - Plus de dossiers cl√¥tur√©s
   - Moins de dossiers cl√¥tur√©s

3. **Donn√©es de Revenus**

   - √âvolution mensuelle
   - Encaissements cl√¥tur√©s vs revers√©s

4. **Analyse des √âcarts**
   - √âcarts par direction r√©gionale
   - Montants A, B, C
   - √âcarts AB et BC

##### **Endpoints Dashboard**

- `GET /dashboard` - Donn√©es principales du dashboard
- `GET /dashboard/revenue` - Donn√©es de revenus
- `GET /dashboard/completion-rate` - Taux de completion
- `GET /dashboard/top-caisses` - Top 5 des caisses
- `GET /dashboard/ecarts` - Donn√©es d'√©carts

#### **3. Module Utilisateurs**

##### **Gestion des Utilisateurs**

**Structure d'un utilisateur :**

- Informations personnelles (nom, pr√©nom, matricule, email)
- Profil et permissions
- Directions r√©gionales assign√©es
- Secteurs assign√©s

**Endpoints :**

- `GET /users` - Liste des utilisateurs
- `GET /users/me` - Informations de l'utilisateur connect√©
- `PATCH /users/me` - Mise √† jour du profil
- `PATCH /users/:id/activate` - Activer un utilisateur
- `PATCH /users/:id/deactivate` - D√©sactiver un utilisateur

#### **4. Module Profils et Permissions**

##### **Syst√®me de Permissions**

Le syst√®me utilise un mod√®le de permissions bas√© sur :

- **Profils** : R√¥les d'utilisateur (Admin, User, Guest)
- **Objets** : Ressources du syst√®me
- **Permissions** : Actions autoris√©es (Cr√©er, Lire, Modifier, Supprimer)

##### **Profils Pr√©d√©finis**

1. **ADMIN** (Level 1)

   - Acc√®s complet au syst√®me
   - Gestion des utilisateurs
   - Configuration syst√®me

2. **USER** (Level 2)

   - Acc√®s aux fonctionnalit√©s m√©tier
   - Validation des encaissements

3. **GUEST** (Level 3)
   - Acc√®s en lecture seule

#### **5. Module Rapprochements**

##### **Types de Rapprochements**

1. **JADE/SAPHIR**

   - Rapprochement entre syst√®mes JADE et SAPHIR
   - Comparaison des montants ch√®ques et esp√®ces

2. **JADE/SMART**

   - Rapprochement entre JADE et SMART
   - Focus sur les montants esp√®ces

3. **Rapprochement Timbres**
   - V√©rification des montants de timbres
   - Comparaison JADE vs encaissements

---

### **Interface d'Administration**

#### **Gestion des Utilisateurs**

1. **Cr√©ation d'utilisateur**

   - Formulaire avec informations obligatoires
   - Assignation de profil
   - S√©lection des directions r√©gionales et secteurs
   - Envoi automatique d'email avec identifiants

2. **Gestion des statuts**
   - Activation/D√©sactivation
   - Verrouillage de compte
   - R√©initialisation de mot de passe

#### **Gestion des Profils**

1. **Cr√©ation de profils personnalis√©s**
2. **Attribution de permissions granulaires**
3. **Gestion des niveaux d'acc√®s**

#### **Configuration Syst√®me**

1. **Param√®tres g√©n√©raux**

   - Seuils d'alerte
   - Configuration des emails
   - Param√®tres de s√©curit√©

2. **Gestion des r√©f√©rentiels**
   - Directions r√©gionales
   - Secteurs
   - Banques
   - Produits

---

### **API et Endpoints**

#### **Structure des R√©ponses**

Toutes les r√©ponses API suivent le format standard :

```json
{
  "data": {
    // Donn√©es de la r√©ponse
  },
  "message": "Message descriptif",
  "success": true,
  "statusCode": 200
}
```

#### **Pagination**

Les endpoints de liste supportent la pagination :

**Param√®tres de query :**

- `page` : Num√©ro de page (d√©faut: 1)
- `limit` : Nombre d'√©l√©ments par page (d√©faut: 10)
- `sortBy` : Champ de tri
- `sortDirection` : Direction du tri (asc/desc)
- `search` : Terme de recherche

**R√©ponse pagin√©e :**

```json
{
  "data": {
    "result": [], // Donn√©es
    "total": 100, // Total d'√©l√©ments
    "page": 1, // Page actuelle
    "limit": 10, // Limite par page
    "totalPages": 10 // Total de pages
  }
}
```

#### **Filtres**

La plupart des endpoints supportent des filtres :

```json
{
  "filters": {
    "periode": {
      "startDate": "2024-01-01",
      "endDate": "2024-12-31"
    },
    "directionRegional": ["DR1", "DR2"],
    "banque": ["BANQUE1", "BANQUE2"],
    "produit": ["PRODUIT1"],
    "statut": [1, 2]
  }
}
```

#### **Endpoints Principaux**

##### **Authentification**

```
POST /auth/sign-in              # Connexion
POST /auth/sign-up              # Inscription (Admin)
POST /auth/refresh-token        # Renouvellement token
POST /auth/logout               # D√©connexion
POST /auth/change-password      # Changement mot de passe
POST /auth/request-reset-password # Demande r√©initialisation
POST /auth/reset-password       # R√©initialisation
```

##### **Encaissements**

```
GET /encaissements              # Liste des encaissements
GET /encaissements/alerts       # Alertes
GET /encaissements/alerts-count # Compteur d'alertes
POST /encaissements/treatment   # Traitement
GET /encaissements/banques      # Liste des banques
GET /encaissements/produits     # Liste des produits
```

##### **Dashboard**

```
GET /dashboard                  # Donn√©es principales
GET /dashboard/revenue          # Donn√©es revenus
GET /dashboard/completion-rate  # Taux completion
GET /dashboard/top-caisses      # Top caisses
GET /dashboard/ecarts          # Donn√©es √©carts
```

##### **Utilisateurs**

```
GET /users                     # Liste utilisateurs
GET /users/me                  # Profil utilisateur
PATCH /users/me               # Mise √† jour profil
PATCH /users/:id/activate     # Activation
PATCH /users/:id/deactivate   # D√©sactivation
```

---

### **Gestion des Permissions**

#### **Matrice de Permissions**

Le syst√®me utilise une matrice Profil x Objet x Permission :

| Profil | Objet         | Permissions |
| ------ | ------------- | ----------- |
| ADMIN  | Tous          | C, R, U, D  |
| USER   | Encaissements | R, U        |
| USER   | Dashboard     | R           |
| GUEST  | Dashboard     | R           |

#### **V√©rification des Permissions**

Les permissions sont v√©rifi√©es √† deux niveaux :

1. **Guards** : V√©rification au niveau des routes
2. **Services** : V√©rification au niveau m√©tier

#### **Configuration des Permissions**

Les permissions sont configur√©es dans la base de donn√©es via les tables :

- `Profile` : D√©finition des profils
- `Permission` : Types de permissions
- `Object` : Objets du syst√®me
- `ProfileObjectPermissions` : Association des permissions

---

### **Rapports et Statistiques**

#### **Types de Rapports**

1. **Rapports Op√©rationnels**

   - Encaissements par p√©riode
   - Statut des validations
   - R√©clamations en cours

2. **Rapports Financiers**

   - Montants encaiss√©s
   - √âcarts identifi√©s
   - Rapprochements comptables

3. **Rapports de Performance**
   - Temps de traitement
   - Taux de validation
   - Performance par caisse

#### **Syst√®me d'Alertes**

##### **Types d'Alertes**

1. **Alertes de D√©lais**

   - Dossiers CHARGES > 5 jours
   - Dossiers VERIFIES > 3 jours
   - Dossiers TRAITES > 2 jours
   - R√©clamations > 7 jours

2. **Alertes d'√âcarts**
   - √âcarts significatifs d√©tect√©s
   - Montants incoh√©rents

##### **Configuration des Seuils**

Les seuils d'alerte sont configurables dans `src/shared/enums/enum.ts` :

```typescript
export enum ESeuils {
  CHARGES = 5, // 5 jours
  VERIFIE = 3, // 3 jours
  VALIDE = 2, // 2 jours
  LITIGE = 7, // 7 jours
}
```

#### **Exports de Donn√©es**

Le syst√®me permet l'export des donn√©es en diff√©rents formats :

- Excel (XLSX)
- CSV
- PDF (rapports)

---

### **Maintenance et Troubleshooting**

#### **Monitoring**

##### **Logs d'Application**

Les logs sont g√©r√©s par NestJS et incluent :

- Logs d'authentification
- Logs d'erreurs
- Logs de performance
- Logs de s√©curit√©

##### **Historique des Actions**

Le syst√®me maintient un historique complet des actions via :

- `Action` : Log des actions utilisateur
- `ConnectionHistory` : Historique des connexions
- Audit trail des modifications

#### **Sauvegarde et Restauration**

##### **Sauvegarde de la Base de Donn√©es**

```bash
# Sauvegarde compl√®te
mysqldump -u username -p suivi_encaissement_db > backup.sql

# Sauvegarde avec compression
mysqldump -u username -p suivi_encaissement_db | gzip > backup.sql.gz
```

##### **Restauration**

```bash
# Restauration
mysql -u username -p suivi_encaissement_db < backup.sql

# Restauration depuis archive compress√©e
gunzip < backup.sql.gz | mysql -u username -p suivi_encaissement_db
```

#### **Probl√®mes Courants**

##### **1. Probl√®me de Connexion √† la Base de Donn√©es**

**Sympt√¥mes :** Erreurs de connexion Prisma

**Solution :**

1. V√©rifier les param√®tres `DATABASE_URL`
2. V√©rifier que MySQL est d√©marr√©
3. Tester la connectivit√© r√©seau

##### **2. Erreurs d'Authentification JWT**

**Sympt√¥mes :** Tokens invalides ou expir√©s

**Solution :**

1. V√©rifier `JWT_SECRET` et `REFRESH_TOKEN_SECRET`
2. V√©rifier la synchronisation des horloges
3. Renouveler les tokens via `/auth/refresh-token`

##### **3. Probl√®mes d'Email**

**Sympt√¥mes :** Emails non envoy√©s

**Solution :**

1. V√©rifier la configuration SMTP
2. V√©rifier les credentials email
3. Tester la connectivit√© SMTP

##### **4. Performances Lentes**

**Sympt√¥mes :** Requ√™tes lentes

**Solution :**

1. V√©rifier les index de base de donn√©es
2. Optimiser les requ√™tes Prisma
3. Impl√©menter la mise en cache

#### **Commandes Utiles**

```bash
# D√©veloppement
npm run dev                    # D√©marrer en mode d√©veloppement
npm run start:debug           # D√©marrer avec debugger

# Base de donn√©es
npm run g                     # G√©n√©rer client Prisma
npm run m                     # Migrer la base
npm run s                     # Ouvrir Prisma Studio
npm run p                     # Push vers la base

# Docker
npm run dup                   # Docker compose up
npm run ddo                   # Docker compose down
npm run d:d image_name        # Build image Docker

# Tests
npm run test                  # Tests unitaires
npm run test:e2e             # Tests end-to-end
npm run test:cov             # Couverture de tests

# Production
npm run build                 # Build production
npm run start:prod           # D√©marrer en production
```

---

### **FAQ**

#### **Questions G√©n√©rales**

**Q: Comment cr√©er un nouvel utilisateur ?**
R: Seuls les administrateurs peuvent cr√©er des utilisateurs via l'endpoint `/auth/sign-up`. L'utilisateur recevra ses identifiants par email.

**Q: Que faire si un utilisateur oublie son mot de passe ?**
R: L'utilisateur peut demander une r√©initialisation via `/auth/request-reset-password`. Un code OTP sera envoy√© par email.

**Q: Comment sont calcul√©s les √©carts ?**
R: Les √©carts sont calcul√©s automatiquement :

- √âcart A-B : Diff√©rence entre montant caisse et bordereau banque
- √âcart B-C : Diff√©rence entre bordereau banque et relev√©

#### **Questions Techniques**

**Q: Comment modifier les seuils d'alerte ?**
R: Les seuils sont d√©finis dans `src/shared/enums/enum.ts` dans l'enum `ESeuils`.

**Q: Comment ajouter une nouvelle permission ?**
R:

1. Ajouter l'objet dans la table `Object`
2. Cr√©er les permissions associ√©es
3. Configurer les profils dans `ProfileObjectPermissions`

**Q: Comment personnaliser les templates d'email ?**
R: Les templates sont dans `src/mail/templates/`. Modifier les fichiers `.hbs` selon vos besoins.

#### **R√©solution de Probl√®mes**

**Q: L'application ne d√©marre pas**
R:

1. V√©rifier le fichier `.env`
2. S'assurer que MySQL est d√©marr√©
3. V√©rifier les d√©pendances avec `npm install`

**Q: Les emails ne partent pas**
R:

1. V√©rifier la configuration SMTP
2. Tester avec un client email externe
3. V√©rifier les logs d'erreur

**Q: Les performances sont lentes**
R:

1. V√©rifier les index de base de donn√©es
2. Analyser les requ√™tes lentes
3. Consid√©rer la mise en cache

---

### **Support et Contact**

#### **√âquipe de D√©veloppement**

**D√©veloppeur Principal :** Siaka DIARRASSOUBA

- **Email :** Siaka1.diarrassouba@cie.ci
- **Contact :** +225 05 64 34 03 44

#### **Ressources Utiles**

- **Documentation Prisma :** https://www.prisma.io/docs/
- **Documentation NestJS :** https://docs.nestjs.com/
- **Documentation MySQL :** https://dev.mysql.com/doc/

#### **Reporting de Bugs**

Pour reporter un bug :

1. D√©crire le comportement attendu vs observ√©
2. Fournir les √©tapes de reproduction
3. Inclure les logs d'erreur
4. Pr√©ciser l'environnement (d√©veloppement/production)

---

_Derni√®re mise √† jour : D√©cembre 2024_
_Version Frontend : 1.0.0_
_Version Backend : 0.0.1_
